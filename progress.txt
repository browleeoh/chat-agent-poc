# Progress Log

## 2026-01-02

Implemented PRD item #8: Focus refresh uses shared hook with main page

- Created `app/hooks/use-focus-revalidate.ts` - reusable hook for focus-based revalidation
- Hook uses `useRevalidator` from react-router, supports optional interval polling
- Refactored `_index.tsx` to use the new hook instead of inline fetcher logic
- Simplified main page: removed manual poller fetcher, now uses `useFocusRevalidate({ enabled: !!selectedRepoId, intervalMs: 5000 })`

Next: Changelog preview page needs to be created and should use this same hook for focus revalidation.

---

Implemented PRD items #1 & #2: Preview Changelog action visibility

- Added "Preview Changelog" action to Version section in Actions dropdown (`_index.tsx`)
- Action only shows when `versions.length > 1` (hidden for single-version repos)
- Links to `/repos/${repoId}/changelog` route (page not yet created)
- Added FileText icon import from lucide-react

Next: Create changelog preview page route at `app/routes/repos.$repoId.changelog.tsx`

---

Implemented PRD items #3-7: Changelog preview page

- Created `app/routes/repos.$repoId.changelog.tsx` - changelog preview page route
- Page fetches repo and version structure via `DBService.getAllVersionsWithStructure`
- Generates changelog markdown via existing `generateChangelog` from `changelog-service.ts`
- Renders markdown as HTML using `react-markdown` (prose styling via Tailwind)
- Back navigation button returns to main page with repo selected
- Uses `useFocusRevalidate` hook for auto-refresh on focus

PRD is now complete - all 8 items passing.
