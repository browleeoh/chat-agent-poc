## Issue #1 - Beat dots orange → light grey
- Changed BeatIndicator dots from bg-orange-500 to bg-zinc-400
- File: app/features/video-editor/video-editor.tsx:886-894

## Issue #2 - Remove pause icon from video editor
- Removed PauseIcon from timecode overlay on clip thumbnails
- BeatIndicator (three ellipses) now serves as the only beat indicator
- Kept PauseIcon in context menu for "Add/Remove Beat" action
- File: app/features/video-editor/video-editor.tsx:730-732 (removed)

## Issue #5 - Scene-based overlay visibility
- Half-opaque overlay now only shows when current OBS scene matches previous clip's scene
- If no scene detected (OBS not connected or clip has no scene), defaults to showing overlay
- File: app/features/video-editor/video-editor.tsx:370-391

## Issue #6 - Changelog shows updated/changed videos
- Content changes (changed transcripts) were being detected but not displayed
- Added `updatedLessons` to `SectionChanges` type
- Track content changes when organizing changes by section
- Added "#### Updated" section in changelog output for lessons with transcript changes
- File: app/services/changelog-service.ts:220-226, 246, 266-269, 380, 423-431

## Issue #7 - Renames only count actual name changes, not number changes
- Previously, changing `01.03-choosing-your-model` to `01.04-choosing-your-model` was detected as a rename
- Added `stripNumericPrefix()` and `hasNameChanged()` helper functions
- Updated section rename detection to use `hasNameChanged()` instead of path inequality
- Updated lesson rename detection to use `hasNameChanged()` instead of path inequality
- Now only detects renames when the actual name portion changes (e.g., `streaming-objects` → `generating-objects-via-output`)
- File: app/services/changelog-service.ts:203-218, 123, 146

## Issue #3 - Export video from course page context menu
- Added "Export" option to video right-click context menu on course page
- Added `exportVideoFetcher` using React Router's `useFetcher` hook
- Export menu item posts to existing `/api/videos/$videoId/export` endpoint
- Uses Download icon to indicate export action
- File: app/routes/_index.tsx:266, 834-844

## Issue #8 - Publish not respecting repo versions
- Publish endpoint was using `getRepoWithSectionsById` which returns ALL sections for a repo, regardless of version
- Changed to first get the latest version via `getLatestRepoVersion`
- Then use `getRepoWithSectionsByVersion` to fetch only sections from the latest version
- This ensures only the latest version's sections are published to Dropbox
- File: app/routes/api.repos.publish-to-dropbox.ts:93-107

## Issue #9 - Add glossary to changelog
- Added a glossary section at the top of the changelog explaining what each term means
- New Lessons: Newly added content
- Renamed: The lesson or section name has changed
- Updated: The video has been updated and the readme needs to be rewritten
- Deleted: The lesson or section has been removed
- File: app/services/changelog-service.ts:341-351

## Issue #10 - Allow users to move clips up and down in the video editor
- Added keyboard hotkeys: Alt+Up moves selected clip up, Alt+Down moves selected clip down
- Added context menu options "Move Up" and "Move Down" (disabled at boundaries)
- Implemented using existing reducer pattern:
  - Added `move-clip` action to clip-state-reducer.ts with `reorder-clip` effect
  - Added `press-alt-arrow-up` and `press-alt-arrow-down` actions to video-state-reducer.ts
  - Added `move-clip` effect that triggers parent's onMoveClip callback
- Created new API endpoint `/clips/reorder` for database sync
- Added `reorderClip` function to DBService using fractional-indexing for order calculation
- Files changed:
  - app/features/video-editor/clip-state-reducer.ts
  - app/features/video-editor/video-state-reducer.ts
  - app/features/video-editor/video-editor.tsx
  - app/routes/videos.$videoId.edit.tsx
  - app/services/db-service.ts
  - app/routes/clips.reorder.ts (new)

## Issue #11 - Allow the write page to work for stand-alone videos
- Write page now works for videos without a lesson (standalone videos)
- For standalone videos:
  - File tree is hidden (no files to show)
  - README writing dropdown is hidden (no explainer/problem folder)
  - Video player moves to the chat area above the conversation
  - Chat column takes full width
  - Header shows just video name (not section/lesson/video path)
  - Back button navigates to home instead of repo view
  - Copy functionality still works
- Key decision: Pass empty string for `imageBasePath` when standalone (no local files to reference)
- File: app/routes/videos.$videoId.write.tsx:75-164, 329-374, 417, 521-585

## Issue #12 - Transcript toggle on write article page
- Added checkbox above file tree to toggle transcript inclusion in prompts
- Displays word count next to checkbox (e.g., "Transcript (1,234 words)")
- When unchecked, transcript is not passed to the AI prompts
- Changes:
  - Loader now fetches video with clips via `getVideoWithClipsById` and calculates word count
  - Added `includeTranscript` state (defaults to true) and UI checkbox
  - Completions endpoint schema accepts `includeTranscript` parameter
  - `acquireTextWritingContext` returns empty transcript when `includeTranscript` is false
  - Updated all prompt functions to conditionally include transcript section:
    - generate-article.ts
    - generate-steps-to-complete-for-project.ts
    - generate-steps-to-complete-for-skill-building-problem.ts
    - refine-skill-building-with-style-guide.ts
    - refine-project-with-style-guide.ts
- Files changed:
  - app/routes/videos.$videoId.write.tsx
  - app/routes/videos.$videoId.completions.ts
  - app/services/text-writing-agent.ts
  - app/prompts/generate-article.ts
  - app/prompts/generate-steps-to-complete-for-project.ts
  - app/prompts/generate-steps-to-complete-for-skill-building-problem.ts
  - app/prompts/refine-skill-building-with-style-guide.ts
  - app/prompts/refine-project-with-style-guide.ts

## Issue #14 - Add link from write article page to edit video page
- Added "Edit Video" button in the header of the write article page
- Button links to `/videos/:videoId/edit` for quick navigation to the video editor
- Uses FilmIcon to indicate video editing functionality
- Placed before the Previous/Next navigation buttons
- File: app/routes/videos.$videoId.write.tsx:358-363

## Issue #13 - Add SEO description mode to write article page
- Created new prompt file for SEO description generation with 160 character limit
- Added "seo-description" mode to frontend Mode type and modeToLabel mapping
- Added new SelectItem in UI for SEO Description mode with description
- Updated backend chatSchema to accept "seo-description" in mode union
- Added "seo-description" to TextWritingAgentMode type in text-writing-agent.ts
- Wired up SEO mode in createTextWritingAgent switch statement
- Prompt emphasizes 160 character hard limit and SEO best practices
- Mode takes transcript and optional code files as context
- Files changed:
  - app/prompts/generate-seo-description.ts (new)
  - app/routes/videos.$videoId.write.tsx:203-209, 212-218, 514-521
  - app/routes/videos.$videoId.completions.ts:13-26
  - app/services/text-writing-agent.ts:1-6, 21-27, 72-77

## Issue #15 - Align transcript checkbox with files in context checkboxes
- Removed border and padding from FileTree component container
- Transcript checkbox now visually aligns with file tree checkboxes
- Only removed `border rounded-lg p-2` classes from the wrapper div
- Kept scrollbar styling and max-height for overflow handling
- File: app/components/FileTree.tsx:213

## Issue #16 - Add icons to writing modes in the selector
- Added icons to each writing mode in the selector dropdown to make them visually distinct
- Icons chosen:
  - Article: FileTextIcon (writing text content)
  - Project Steps: ListChecksIcon (checklist)
  - Skill Building Steps: GraduationCapIcon (learning/education)
  - Style Guide Pass - Skill Building: RefreshCwIcon (refinement)
  - Style Guide Pass - Project: RefreshCwIcon (refinement)
  - SEO Description: SearchIcon (search optimization)
- Updated SelectItem components to include flex layout with icon on the left
- File: app/routes/videos.$videoId.write.tsx:43-57, 479-544

## Issue #17 - Remove microphone monitoring from empty video editor state
- Removed microphone monitoring list item from pre-recording checklist in empty state
- Deleted `VolumeIndicator` component (volume-indicator.tsx) that displayed live audio levels
- Deleted `useVolumeLevel` hook (use-volume-level.ts) that consumed CPU cycles monitoring MediaStream
- Removed imports for VolumeIndicator and useVolumeLevel from video-editor.tsx
- Removed volumeLevel hook usage that was creating AudioContext and running requestAnimationFrame loop
- This eliminates unnecessary CPU usage when the video editor has no clips
- Files changed:
  - app/features/video-editor/video-editor.tsx:76-77, 148, 653-661 (removed)
  - app/features/video-editor/volume-indicator.tsx (deleted)
  - app/features/video-editor/use-volume-level.ts (deleted)

## Issue #18 - Video Editor Clip Sections (Part 1: Database Layer)
- Created `clipSections` database table with schema matching PRD specifications
- Table includes: id (UUID), videoId (FK with cascade delete), name (text), order (varchar COLLATE "C"), archived (boolean), createdAt (timestamp)
- Added Drizzle relations for clipSections to videos (one-to-many)
- Implemented DB operations in DBService: createClipSection, getClipSectionById, updateClipSection, archiveClipSection, reorderClipSection
- reorderClipSection implements unified ordering by fetching both clips and clip sections, combining them, sorting by order field, and calculating new fractional position
- Key decision: Clip sections and clips share the same fractional ordering space using varchar COLLATE "C" for proper sorting
- All tests and typecheck pass
- Files changed:
  - app/db/schema.ts:151-168, 180-182, 187 (added clipSections table and relations)
  - app/services/db-service.ts:2, 162-335, 568-572 (added clipSections import and CRUD operations)

## Issue #18 - Video Editor Clip Sections (Part 2: API Routes)
- Created four API routes for clip section operations following existing clip route patterns
- Routes follow Effect-based architecture with Schema validation and error handling
- All routes use withDatabaseDump for data persistence and layerLive for dependency injection
- Key decision: Archive route supports both single ID and array of IDs (same pattern as clips.archive.ts)
- All tests and typecheck pass
- Files changed:
  - app/routes/clip-sections.create.ts (new) - creates clip section with videoId, name, order
  - app/routes/clip-sections.update.ts (new) - updates clip section name
  - app/routes/clip-sections.archive.ts (new) - soft deletes one or more clip sections
  - app/routes/clip-sections.reorder.ts (new) - moves clip section up/down in unified ordering

## Issue #18 - Video Editor Clip Sections (Part 3: Frontend State Integration)
- Integrated ClipSection types into video editor state management
- State now uses unified `TimelineItem[]` array (clips and clip sections together)
- Added new types:
  - `ClipSectionOnDatabase` and `ClipSectionOptimisticallyAdded` in clip-state-reducer.ts
  - `TimelineItem = Clip | ClipSection` union type
  - `ApiInsertionPoint` - narrower type for backend API communication
- Updated `FrontendInsertionPoint` to include `after-clip-section` variant
- Updated `DatabaseInsertionPoint` to include `after-clip-section` variant
- Renamed state property from `clips` to `items` throughout:
  - clip-state-reducer.ts: State now has `items: TimelineItem[]`
  - video-editor.tsx: Added `isClip()` helper, uses local `clips` derived from `props.items`
  - videos.$videoId.edit.tsx: Passes `items` prop, filters archived items
- Updated `toDatabaseInsertionPoint` to handle `after-clip-section` (converts to `after-clip` or `start` for API)
- Updated OBS connector to use `ApiInsertionPoint` type
- Added DB.ClipSection type to schema.ts namespace
- All tests and typecheck pass
- Key decision: Clip sections filtered out in VideoEditor for now - UI components added in future task
- Files changed:
  - app/db/schema.ts (added DB.ClipSection type)
  - app/features/video-editor/clip-state-reducer.ts (major state refactoring)
  - app/features/video-editor/clip-state-reducer.test.ts (updated to use items)
  - app/features/video-editor/video-editor.tsx (items prop, isClip helper)
  - app/features/video-editor/obs-connector.tsx (ApiInsertionPoint type)
  - app/routes/videos.$videoId.edit.tsx (items prop, ApiInsertionPoint)

## Issue #18 - Video Editor Clip Sections (Part 4: Loader Fetches ClipSections)
- Updated `getVideoWithClipsById` in DBService to also fetch clipSections
- Query now includes `clipSections` relation with same ordering and archived filtering as clips
- Updated video editor loader to combine clips and clipSections into unified sorted `items` array
- Items are sorted by `order` field using localeCompare (matches varchar COLLATE "C" behavior)
- Loader now returns `items` instead of `clips` - each item tagged with `type: "clip"` or `type: "clip-section"`
- ComponentInner maps loader items to proper TimelineItem types:
  - Clips become `ClipOnDatabase` with `type: "on-database"`
  - ClipSections become `ClipSectionOnDatabase` with `type: "clip-section-on-database"`
- All tests pass (21 passed, 1 todo)
- TypeScript typechecks pass
- Files changed:
  - app/services/db-service.ts:504-509 (added clipSections to query)
  - app/routes/videos.$videoId.edit.tsx:45-70, 89-117 (loader returns items, component maps to TimelineItem)

## Issue #18 - Video Editor Clip Sections (Part 5: Stream Deck Integration)
- Added Stream Deck support for creating clip sections via HTTP/WebSocket
- Stream Deck HTTP endpoint: `/api/add-clip-section` on port 5174
- WebSocket message: `{ type: "add-clip-section" }` broadcast on port 5172
- New message type added to `streamDeckForwarderMessageSchema`
- Implementation:
  - `add-clip-section` action added to `clipStateReducer` - creates optimistic clip section at insertion point
  - `create-clip-section` effect fires to persist to database
  - Default naming: "Section 1", "Section 2", etc. based on existing clip section count
  - Insertion point moves to after new clip section
- New DBService operation: `createClipSectionAtInsertionPoint` - calculates fractional order from insertion point
- New API route: `/clip-sections/create-at-insertion-point` - accepts insertion point, calculates order internally
- Key decision: Order calculation moved to backend (like clips) rather than frontend passing raw order
- All tests pass (21 passed, 1 todo)
- TypeScript typechecks pass
- Files changed:
  - stream-deck-forwarder/stream-deck-forwarder-types.ts (added add-clip-section message type)
  - stream-deck-forwarder/run-stream-deck-forwarder.ts (added HTTP endpoint)
  - app/features/video-editor/clip-state-reducer.ts (added action and effect types, reducer case)
  - app/features/video-editor/video-editor.tsx (WebSocket handler, onAddClipSection prop, name generator)
  - app/routes/videos.$videoId.edit.tsx (effect handler, onAddClipSection prop)
  - app/services/db-service.ts (added createClipSectionAtInsertionPoint)
  - app/routes/clip-sections.create-at-insertion-point.ts (new API route)

## Issue #18 - Video Editor Clip Sections (Part 6: UI Components)
- Added `ClipSectionDivider` UI component for rendering clip sections in timeline
- Clip sections now render as horizontal divider lines with the section name centered
- Visual design: Gray horizontal lines with section name label in between
- Selectable: Click to select, participates in selection state (outline when selected)
- Insertion point indicator shows after clip sections when insertion point is set there
- Refactored timeline rendering to iterate over `props.items` (unified array) instead of just clips
- Added `isClipSection()` type guard helper alongside existing `isClip()` helper
- Extracted clip computed properties (timecode, levenshtein) into a Map for cleaner code
- Move Up/Down context menu now correctly uses unified item index for boundaries
- All tests pass (21 passed, 1 todo)
- TypeScript typechecks pass
- Files changed:
  - app/features/video-editor/video-editor.tsx (ClipSectionDivider component, refactored rendering loop)

## Issue #18 - Video Editor Clip Sections (Part 7: Context Menu & Keyboard Shortcuts)
- Added context menu to ClipSectionDivider with: Insert Before, Insert After, Move Up, Move Down, Delete
- ClipSectionDivider component now uses forwardRef to work with ContextMenuTrigger
- Added new effects to clip-state-reducer: `reorder-clip-section` and `archive-clip-sections`
- Updated `move-clip` action to fire correct effect based on item type (clip vs clip section)
- Updated `archiveClips` helper to track and return `clipSectionsToArchive` separately
- All call sites of `archiveClips` now fire both `archive-clips` and `archive-clip-sections` effects
- Updated `set-insertion-point-after` to set correct insertion point type based on item
- Updated `set-insertion-point-before` to handle previous item being a clip section
- Updated `archiveClips` to handle `after-clip-section` insertion point when clip section is deleted
- Updated `press-delete` case to handle deletion of clip sections (not just clips)
- Added effect handlers in videos.$videoId.edit.tsx for `reorder-clip-section` and `archive-clip-sections`
- All keyboard shortcuts (Delete, Alt+Up, Alt+Down) now work for clip sections
- All tests pass (21 passed, 1 todo)
- TypeScript typechecks pass
- Files changed:
  - app/features/video-editor/video-editor.tsx (context menu, forwardRef for ClipSectionDivider)
  - app/features/video-editor/clip-state-reducer.ts (new effects, updated actions and archiveClips)
  - app/features/video-editor/video-state-reducer.ts (updated press-delete handling)
  - app/routes/videos.$videoId.edit.tsx (new effect handlers)

## Issue #18 - Video Editor Clip Sections (Part 8: Naming Modal)
- Added naming modal that appears when creating a clip section via Stream Deck
- Modal allows user to enter a custom name or dismiss to use default name ("Section N")
- Added "Edit" option to clip section context menu for renaming existing sections
- Implementation details:
  - Added `clipSectionNamingModal` state to VideoEditor with two modes: "create" and "edit"
  - Stream Deck handler now opens modal instead of immediately creating clip section
  - Modal has "Skip" button for create mode (uses default name) and "Cancel" for edit mode
  - Auto-focus on input field for quick naming
  - Added `update-clip-section` action and effect to clip-state-reducer
  - Added `onUpdateClipSection` prop to VideoEditor
  - Added effect handler for `update-clip-section` that calls `/clip-sections/update` API
- User Stories addressed: 9, 10, 11, 12, 17 (partial - Edit action added)
- All tests pass (21 passed, 1 todo)
- TypeScript typechecks pass
- Files changed:
  - app/features/video-editor/clip-state-reducer.ts (new action and effect types, new reducer case)
  - app/features/video-editor/video-editor.tsx (modal state, modal component, context menu Edit option)
  - app/routes/videos.$videoId.edit.tsx (effect handler, onUpdateClipSection prop)

## Issue #18 - Video Editor Clip Sections (Part 9: YouTube Timestamp Export)
- Added YouTube chapter generation and copy functionality to export modal
- Chapters automatically calculated from clip durations before each clip section
- Format follows YouTube standard: "0:00 Section Name" per line
- Implementation details:
  - Added `youtubeChapters` useMemo that iterates through all items (clips and clip sections)
  - Tracks cumulative duration, records timestamp at each clip section
  - Added `copyYoutubeChaptersToClipboard` function with copy feedback state
  - Export modal conditionally shows "YouTube Chapters" section when chapters exist
  - Chapters displayed in monospace font with "Copy" button
- User Stories addressed: 26, 27, 28, 29 (YouTube timestamp export functionality)
- All tests pass (21 passed, 1 todo)
- TypeScript typechecks pass
- Files changed:
  - app/features/video-editor/video-editor.tsx (youtubeChapters calculation, copy function, export modal UI)
